import{a as z}from"./chunk-2PSR7T7J.js";import{a as B,b as c,c as U,d as G,e as R,f as q,g as O,i as P,j as $,k as j,l as L,r as K,s as H,t as Y,u as Z}from"./chunk-IAQZ57CQ.js";import{B as a,C as b,F as k,G as h,I as s,K as i,L as t,M as p,P as f,Q as g,R as u,S as o,T as x,U as _,W as T,Y as E,Z as S,a as F,b as M,c as y,da as N,ea as I,fa as A,ga as w,ha as W,na as D,s as V,w as C,x as v}from"./chunk-ACHKL7EZ.js";function X(l,d){if(l&1&&(i(0,"span",42),o(1),t()),l&2){let e=u().$implicit,n=u();a(),_(" ",n.getErrorMessage(e,"marca")," ")}}function ee(l,d){if(l&1&&(i(0,"span",42),o(1),t()),l&2){let e=u().$implicit,n=u();a(),_(" ",n.getErrorMessage(e,"unidades_vendidas")," ")}}function te(l,d){if(l&1&&(i(0,"span",42),o(1),t()),l&2){let e=u().$implicit,n=u();a(),_(" ",n.getErrorMessage(e,"marketshare")," ")}}function ie(l,d){if(l&1){let e=f();i(0,"button",43),g("click",function(){C(e);let r=u().index,m=u();return v(m.eliminarFilaMotosCombustion(r))}),o(1," \u274C "),t()}}function re(l,d){if(l&1&&(i(0,"tr",35)(1,"td"),p(2,"input",36),h(3,X,2,1,"span",37),t(),i(4,"td"),p(5,"input",38),h(6,ee,2,1,"span",37),t(),i(7,"td"),p(8,"input",39),h(9,te,2,1,"span",37),t(),i(10,"td",40),h(11,ie,2,0,"button",41),t()()),l&2){let e=d.$implicit,n=d.index,r=u();s("formGroupName",n),a(2),s("ngClass",r.getFieldClass(e,"marca")),a(),s("ngIf",r.shouldShowError(e,"marca")),a(2),s("ngClass",r.getFieldClass(e,"unidades_vendidas")),a(),s("ngIf",r.shouldShowError(e,"unidades_vendidas")),a(2),s("ngClass",r.getFieldClass(e,"marketshare")),a(),s("ngIf",r.shouldShowError(e,"marketshare")),a(2),s("ngIf",r.motosCombustion.length>1)}}function oe(l,d){if(l&1){let e=f();i(0,"button",43),g("click",function(){C(e);let r=u().index,m=u();return v(m.eliminarFilaVentasMotos(r))}),o(1," \u274C "),t()}}function ne(l,d){if(l&1&&(i(0,"tr",35)(1,"td"),p(2,"input",44),t(),i(3,"td"),p(4,"input",45),t(),i(5,"td"),p(6,"input",38),t(),i(7,"td",40),h(8,oe,2,0,"button",41),t()()),l&2){let e=d.$implicit,n=d.index,r=u();s("formGroupName",n),a(2),s("ngClass",r.getFieldClass(e,"segmento")),a(2),s("ngClass",r.getFieldClass(e,"modelo")),a(2),s("ngClass",r.getFieldClass(e,"unidades_vendidas")),a(2),s("ngIf",r.ventasMotos.length>1)}}function ae(l,d){if(l&1){let e=f();i(0,"button",43),g("click",function(){C(e);let r=u().index,m=u();return v(m.eliminarFilaMotocarros(r))}),o(1," \u274C "),t()}}function le(l,d){if(l&1&&(i(0,"tr",35)(1,"td"),p(2,"input",36),t(),i(3,"td"),p(4,"input",38),t(),i(5,"td"),p(6,"input",39),t(),i(7,"td",40),h(8,ae,2,0,"button",41),t()()),l&2){let e=d.$implicit,n=d.index,r=u();s("formGroupName",n),a(2),s("ngClass",r.getFieldClass(e,"marca")),a(2),s("ngClass",r.getFieldClass(e,"unidades_vendidas")),a(2),s("ngClass",r.getFieldClass(e,"marketshare")),a(2),s("ngIf",r.motocarros.length>1)}}function se(l,d){if(l&1){let e=f();i(0,"button",43),g("click",function(){C(e);let r=u().index,m=u();return v(m.eliminarFilaMarketshare2W(r))}),o(1," \u274C "),t()}}function me(l,d){if(l&1&&(i(0,"tr",35)(1,"td"),p(2,"input",36),t(),i(3,"td"),p(4,"input",39),t(),i(5,"td",40),h(6,se,2,0,"button",41),t()()),l&2){let e=d.$implicit,n=d.index,r=u();s("formGroupName",n),a(2),s("ngClass",r.getFieldClass(e,"marca")),a(2),s("ngClass",r.getFieldClass(e,"marketshare")),a(2),s("ngIf",r.marketshare2W.length>1)}}function ce(l,d){if(l&1){let e=f();i(0,"button",43),g("click",function(){C(e);let r=u().index,m=u();return v(m.eliminarFilaVentas2W(r))}),o(1," \u274C "),t()}}function de(l,d){if(l&1&&(i(0,"tr",35)(1,"td"),p(2,"input",46),t(),i(3,"td"),p(4,"input",45),t(),i(5,"td"),p(6,"input",38),t(),i(7,"td",40),h(8,ce,2,0,"button",41),t()()),l&2){let e=d.$implicit,n=d.index,r=u();s("formGroupName",n),a(2),s("ngClass",r.getFieldClass(e,"segmento")),a(2),s("ngClass",r.getFieldClass(e,"modelo")),a(2),s("ngClass",r.getFieldClass(e,"unidades_vendidas")),a(2),s("ngIf",r.ventas2W.length>1)}}var xe=(()=>{class l extends Y{constructor(e,n,r,m){super(),this.formBuilder=e,this.formService=n,this.formDataService=r,this.router=m,this.comercialVictory=!0,this.datoscomerciavictory=new R({}),this.filesToUpload=new Map,this.totalUnidadesMotosCombustion=0,this.totalMarketshareMotos=0,this.totalVentasMotos=0,this.totalUnidadesMotocarros=0,this.totalMarketshareCarros=0,this.totalMarketshare2W=0,this.totalVentas2W=0}ngOnInit(){this.datoscomerciavictory=this.formBuilder.group({motos_combustion:this.formBuilder.array([]),ventas_motos:this.formBuilder.array([]),motocarros:this.formBuilder.array([]),marketshare_2w:this.formBuilder.array([]),ventas_2w:this.formBuilder.array([])}),this.agregarFilaMotosCombustion("Victory"),this.agregarFilaMotosCombustion("Kymco"),this.agregarFilaMotosCombustion("Benelli"),this.agregarFilaMotosCombustion("Kawasaki"),this.agregarFilaMotosCombustion("Zontes"),this.agregarFilaVentasMotos(),this.agregarFilaMotocarros(),this.agregarFilaMarketshare2W(),this.agregarFilaVentas2W(),this.datoscomerciavictory.valueChanges.subscribe(()=>{this.calcularTotales()}),this.calcularTotales()}get motosCombustion(){return this.datoscomerciavictory.get("motos_combustion")}agregarFilaMotosCombustion(e=""){let n=this.formBuilder.group({marca:[e,c.required],unidades_vendidas:["",[c.required,c.min(0)]],marketshare:["",[c.required,c.min(0),c.max(100)]]});n.valueChanges.subscribe(()=>this.calcularTotales()),this.motosCombustion.push(n)}eliminarFilaMotosCombustion(e){this.motosCombustion.length>1&&(this.motosCombustion.removeAt(e),this.calcularTotales())}get ventasMotos(){return this.datoscomerciavictory.get("ventas_motos")}agregarFilaVentasMotos(){let e=this.formBuilder.group({segmento:["",c.required],modelo:["",c.required],unidades_vendidas:["",[c.required,c.min(0)]]});e.valueChanges.subscribe(()=>this.calcularTotales()),this.ventasMotos.push(e)}eliminarFilaVentasMotos(e){this.ventasMotos.length>1&&(this.ventasMotos.removeAt(e),this.calcularTotales())}get motocarros(){return this.datoscomerciavictory.get("motocarros")}agregarFilaMotocarros(){let e=this.formBuilder.group({marca:["",c.required],unidades_vendidas:["",[c.required,c.min(0)]],marketshare:["",[c.required,c.min(0),c.max(100)]]});e.valueChanges.subscribe(()=>this.calcularTotales()),this.motocarros.push(e)}eliminarFilaMotocarros(e){this.motocarros.length>1&&(this.motocarros.removeAt(e),this.calcularTotales())}get marketshare2W(){return this.datoscomerciavictory.get("marketshare_2w")}agregarFilaMarketshare2W(){let e=this.formBuilder.group({marca:["",c.required],marketshare:["",[c.required,c.min(0),c.max(100)]]});e.valueChanges.subscribe(()=>this.calcularTotales()),this.marketshare2W.push(e)}eliminarFilaMarketshare2W(e){this.marketshare2W.length>1&&(this.marketshare2W.removeAt(e),this.calcularTotales())}get ventas2W(){return this.datoscomerciavictory.get("ventas_2w")}agregarFilaVentas2W(){let e=this.formBuilder.group({segmento:["",c.required],modelo:["",c.required],unidades_vendidas:["",[c.required,c.min(0)]]});e.valueChanges.subscribe(()=>this.calcularTotales()),this.ventas2W.push(e)}eliminarFilaVentas2W(e){this.ventas2W.length>1&&(this.ventas2W.removeAt(e),this.calcularTotales())}calcularTotales(){this.totalUnidadesMotosCombustion=this.motosCombustion.controls.reduce((e,n)=>e+(Number(n.get("unidades_vendidas")?.value)||0),0),this.totalMarketshareMotos=this.motosCombustion.controls.reduce((e,n)=>e+(Number(n.get("marketshare")?.value)||0),0),this.totalVentasMotos=this.ventasMotos.controls.reduce((e,n)=>e+(Number(n.get("unidades_vendidas")?.value)||0),0),this.totalUnidadesMotocarros=this.motocarros.controls.reduce((e,n)=>e+(Number(n.get("unidades_vendidas")?.value)||0),0),this.totalMarketshareCarros=this.motocarros.controls.reduce((e,n)=>e+(Number(n.get("marketshare")?.value)||0),0),this.totalMarketshare2W=this.marketshare2W.controls.reduce((e,n)=>e+(Number(n.get("marketshare")?.value)||0),0),this.totalVentas2W=this.ventas2W.controls.reduce((e,n)=>e+(Number(n.get("unidades_vendidas")?.value)||0),0)}getNumericValue(e){return Number(this.datoscomerciavictory.get(e)?.value)||0}onFileSelected(e,n){let r=e.target.files[0];r&&(this.filesToUpload.set(n,r),console.log(`Archivo seleccionado: ${r.name} para ${n}`))}convertFileToBase64(e){return y(this,null,function*(){return new Promise((n,r)=>{let m=new FileReader;m.onload=()=>n(m.result),m.onerror=r,m.readAsDataURL(e)})})}submitFormComercialVictory(){return y(this,null,function*(){this.markFormGroupTouched(this.datoscomerciavictory),this.datoscomerciavictory.valid?(console.log("\u2705 Formulario Comercial Victory+ v\xE1lido"),yield this.sendAttachment()):(console.log("\u274C Formulario Comercial Victory+ inv\xE1lido"),this.scrollToFirstError(),alert("Por favor, complete todos los campos obligatorios"))})}sendAttachment(){return y(this,null,function*(){let e=[];for(let[m,J]of this.filesToUpload.entries()){console.log("\u{1F4CE} Procesando archivo:",m);let Q=yield this.convertFileToBase64(J);e.push({fileName:m,fileData:Q})}let n=this.formDataService.getDatosIniciales(),r=M(F({},this.datoscomerciavictory.value),{totales:{motos_combustion:{unidades:this.totalUnidadesMotosCombustion,marketshare:this.totalMarketshareMotos},ventas_motos_modelo:this.totalVentasMotos,motocarros:{unidades:this.totalUnidadesMotocarros,marketshare:this.totalMarketshareCarros},marketshare_2w:this.totalMarketshare2W,ventas_2w:this.totalVentas2W},fecha_reporte:new Date().toISOString()});console.log("\u{1F4CA} Datos a enviar:",r),this.formService.upload(e,n,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,r).subscribe({next:m=>{console.log("\u2705 Datos enviados exitosamente:",m),this.formDataService.clearDatosIniciales(),this.router.navigate(["/confirmacion"])},error:m=>{console.error("\u274C Error al enviar:",m),alert("Hubo un error al enviar los datos. Por favor, intente nuevamente.")}})})}static{this.\u0275fac=function(n){return new(n||l)(b(K),b(z),b(Z),b(D))}}static{this.\u0275cmp=V({type:l,selectors:[["app-comercial-victory"]],standalone:!0,features:[k,T],decls:168,vars:23,consts:[[1,"form-header"],[1,"header-content"],[1,"header-text"],["src","assets/auteco-logo.png","alt","Logo Empresa",1,"logo-empresa"],["id","msform"],[1,"border-victory",3,"hidden"],[3,"ngSubmit","formGroup"],[1,"section-header"],[1,"icon"],[1,"fs-subtitle"],[1,"info-box"],[1,"subsection-header"],[1,"table-subtitle"],[1,"table-container"],[1,"gri-table","victory-table"],[1,"acciones-col"],["formArrayName","motos_combustion"],[3,"formGroupName",4,"ngFor","ngForOf"],[1,"totales-row"],[1,"total-label"],[1,"total-cell"],[1,"resultado-total"],[1,"resultado-total-final"],["type","button",1,"btn-agregar-fila",3,"click"],[1,"table-subtitle",2,"margin-top","40px"],[1,"gri-table","victory-table-ventas"],["formArrayName","ventas_motos"],["colspan","2",1,"total-label"],[1,"table-subtitle",2,"margin-top","50px"],["formArrayName","motocarros"],[1,"subsection-header",2,"margin-top","50px"],[1,"gri-table","victory-table-simple"],["formArrayName","marketshare_2w"],["formArrayName","ventas_2w"],["type","button","value","GUARDAR Y ENVIAR",1,"action-button","success",3,"click"],[3,"formGroupName"],["type","text","formControlName","marca","placeholder","Nombre de la marca",3,"ngClass"],["class","error-text",4,"ngIf"],["type","number","formControlName","unidades_vendidas","placeholder","0",3,"ngClass"],["type","number","formControlName","marketshare","step","0.01","placeholder","0.00",3,"ngClass"],[1,"acciones-cell"],["type","button","class","btn-eliminar","title","Eliminar fila",3,"click",4,"ngIf"],[1,"error-text"],["type","button","title","Eliminar fila",1,"btn-eliminar",3,"click"],["type","text","formControlName","segmento","placeholder","Ej: Scooter, Sport, etc.",3,"ngClass"],["type","text","formControlName","modelo","placeholder","Nombre del modelo",3,"ngClass"],["type","text","formControlName","segmento","placeholder","Ej: Urbano, Delivery, etc.",3,"ngClass"]],template:function(n,r){n&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),p(4,"img",3),o(5," Plataforma de Gesti\xF3n - Informe de Sostenibilidad"),t(),i(6,"p"),o(7,"Sistema de recolecci\xF3n de datos para reportes GRI"),t()()()(),i(8,"form",4)(9,"fieldset",5)(10,"form",6),g("ngSubmit",function(){return r.submitFormComercialVictory()}),i(11,"div",7)(12,"span",8),o(13,"\u{1F3CD}\uFE0F"),t(),i(14,"h2"),o(15,"Participaci\xF3n en el Mercado de Combusti\xF3n"),t()(),i(16,"p",9),o(17," Complete la informaci\xF3n sobre participaci\xF3n en el mercado de veh\xEDculos de combusti\xF3n (motocicletas, motocarros) y el\xE9ctricos (ciclomotores 2W) "),t(),i(18,"div",10)(19,"strong"),o(20,"\u2139\uFE0F INSTRUCCIONES:"),t(),o(21," Complete los datos seg\xFAn corresponda. Las tablas con marcas fijas tienen 5 marcas, las dem\xE1s permiten agregar filas. "),t(),i(22,"div",11)(23,"span",8),o(24,"\u{1F3C1}"),t(),o(25," PARTICIPACI\xD3N EN EL MERCADO DE COMBUSTI\xD3N - Contenido GRI: N/A "),t(),i(26,"h3",12),o(27,"Participaci\xF3n en el mercado de motocicletas a combusti\xF3n"),t(),i(28,"div",13)(29,"table",14)(30,"thead")(31,"tr")(32,"th"),o(33,"Marca"),t(),i(34,"th"),o(35,"Unidades vendidas"),t(),i(36,"th"),o(37,"Marketshare (%)"),t(),i(38,"th",15),o(39,"Acciones"),t()()(),i(40,"tbody",16),h(41,re,12,8,"tr",17),i(42,"tr",18)(43,"td",19)(44,"strong"),o(45,"Total"),t()(),i(46,"td",20)(47,"span",21),o(48),t()(),i(49,"td",20)(50,"span",22),o(51),E(52,"number"),t()(),p(53,"td"),t()()()(),i(54,"button",23),g("click",function(){return r.agregarFilaMotosCombustion("")}),o(55," \u2795 Agregar marca de motocicleta "),t(),i(56,"h3",24),o(57,"Ventas por modelo y segmento de motocicletas a combusti\xF3n"),t(),i(58,"div",13)(59,"table",25)(60,"thead")(61,"tr")(62,"th"),o(63,"Segmento"),t(),i(64,"th"),o(65,"Modelo"),t(),i(66,"th"),o(67,"Unidades vendidas"),t(),i(68,"th",15),o(69,"Acciones"),t()()(),i(70,"tbody",26),h(71,ne,9,5,"tr",17),i(72,"tr",18)(73,"td",27)(74,"strong"),o(75,"Total"),t()(),i(76,"td",20)(77,"span",22),o(78),t()(),p(79,"td"),t()()()(),i(80,"button",23),g("click",function(){return r.agregarFilaVentasMotos()}),o(81," \u2795 Agregar modelo de motocicleta "),t(),i(82,"h3",28),o(83,"Participaci\xF3n en el mercado de motocarros a combusti\xF3n"),t(),i(84,"div",13)(85,"table",14)(86,"thead")(87,"tr")(88,"th"),o(89,"Marca"),t(),i(90,"th"),o(91,"Unidades vendidas"),t(),i(92,"th"),o(93,"Marketshare (%)"),t(),i(94,"th",15),o(95,"Acciones"),t()()(),i(96,"tbody",29),h(97,le,9,5,"tr",17),i(98,"tr",18)(99,"td",19)(100,"strong"),o(101,"Total"),t()(),i(102,"td",20)(103,"span",21),o(104),t()(),i(105,"td",20)(106,"span",22),o(107),E(108,"number"),t()(),p(109,"td"),t()()()(),i(110,"button",23),g("click",function(){return r.agregarFilaMotocarros()}),o(111," \u2795 Agregar marca de motocarro "),t(),i(112,"div",30)(113,"span",8),o(114,"\u26A1"),t(),o(115," PARTICIPACI\xD3N EN EL MERCADO EL\xC9CTRICO 2W - Contenido GRI: N/A "),t(),i(116,"h3",12),o(117,"Participaci\xF3n en el mercado de ciclomotores el\xE9ctricos"),t(),i(118,"div",13)(119,"table",31)(120,"thead")(121,"tr")(122,"th"),o(123,"Marca"),t(),i(124,"th"),o(125,"Marketshare (%)"),t(),i(126,"th",15),o(127,"Acciones"),t()()(),i(128,"tbody",32),h(129,me,7,4,"tr",17),i(130,"tr",18)(131,"td",19)(132,"strong"),o(133,"Total"),t()(),i(134,"td",20)(135,"span",22),o(136),E(137,"number"),t()(),p(138,"td"),t()()()(),i(139,"button",23),g("click",function(){return r.agregarFilaMarketshare2W()}),o(140," \u2795 Agregar marca de ciclomotor el\xE9ctrico "),t(),i(141,"h3",24),o(142,"Ventas por modelo y segmento de ciclomotores el\xE9ctricos"),t(),i(143,"div",13)(144,"table",25)(145,"thead")(146,"tr")(147,"th"),o(148,"Segmento"),t(),i(149,"th"),o(150,"Modelo"),t(),i(151,"th"),o(152,"Unidades vendidas"),t(),i(153,"th",15),o(154,"Acciones"),t()()(),i(155,"tbody",33),h(156,de,9,5,"tr",17),i(157,"tr",18)(158,"td",27)(159,"strong"),o(160,"Total"),t()(),i(161,"td",20)(162,"span",22),o(163),t()(),p(164,"td"),t()()()(),i(165,"button",23),g("click",function(){return r.agregarFilaVentas2W()}),o(166," \u2795 Agregar modelo de ciclomotor el\xE9ctrico "),t(),i(167,"input",34),g("click",function(){return r.submitFormComercialVictory()}),t()()()()),n&2&&(a(9),s("hidden",!r.comercialVictory),a(),s("formGroup",r.datoscomerciavictory),a(31),s("ngForOf",r.motosCombustion.controls),a(7),x(r.totalUnidadesMotosCombustion),a(3),_("",S(52,14,r.totalMarketshareMotos,"1.2-2"),"%"),a(20),s("ngForOf",r.ventasMotos.controls),a(7),x(r.totalVentasMotos),a(19),s("ngForOf",r.motocarros.controls),a(7),x(r.totalUnidadesMotocarros),a(3),_("",S(108,17,r.totalMarketshareCarros,"1.2-2"),"%"),a(22),s("ngForOf",r.marketshare2W.controls),a(7),_("",S(137,20,r.totalMarketshare2W,"1.2-2"),"%"),a(20),s("ngForOf",r.ventas2W.controls),a(7),x(r.totalVentas2W))},dependencies:[W,N,I,A,w,H,q,B,O,U,G,P,L,$,j]})}}return l})();export{xe as ComercialVictoryComponent};
