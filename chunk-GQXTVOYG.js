import{a as B}from"./chunk-24KBMFR6.js";import{a as w}from"./chunk-2PSR7T7J.js";import{a as y,b as c,c as _,d as x,e as N,f as A,g as I,i as T,l as R,p as G,q,r as P,s as J,t as V}from"./chunk-6S4UDF73.js";import{B as l,C as u,F as E,I as s,K as t,L as e,M as m,Q as h,S as o,U as b,W as D,a as F,b as f,c as p,da as S,ha as g,na as j,s as C}from"./chunk-ACHKL7EZ.js";var W=(()=>{class d extends J{constructor(r,n,i,a,v){super(),this.formBuilder=r,this.formService=n,this.formDataService=i,this.calculadora=a,this.router=v,this.anticorrupcion=!0,this.datosanticorrupcion=new N({}),this.filesToUpload=new Map,this.totalJuntaDirectiva=0,this.porcentajeJuntaDirectiva=0,this.totalComiteDirectivo=0,this.porcentajeComiteDirectivo=0,this.totalColaboradores=0,this.porcentajeColaboradores=0}ngOnInit(){this.datosanticorrupcion=this.formBuilder.group({junta_recibieron:["",[c.required,c.min(0)]],junta_total:["",[c.required,c.min(0)]],comite_recibieron:["",[c.required,c.min(0)]],comite_total:["",[c.required,c.min(0)]],colaboradores_recibieron:["",[c.required,c.min(0)]],colaboradores_total:["",[c.required,c.min(0)]]}),this.calcularTotalesAnticorrupcion(),this.datosanticorrupcion.valueChanges.subscribe(()=>{this.calcularTotalesAnticorrupcion()})}calcularTotalesAnticorrupcion(){let r=this.datosanticorrupcion.value,n=this.calculadora.calcularPorcentaje(Number(r.junta_recibieron)||0,Number(r.junta_total)||0);this.totalJuntaDirectiva=n.total,this.porcentajeJuntaDirectiva=n.porcentaje;let i=this.calculadora.calcularPorcentaje(Number(r.comite_recibieron)||0,Number(r.comite_total)||0);this.totalComiteDirectivo=i.total,this.porcentajeComiteDirectivo=i.porcentaje;let a=this.calculadora.calcularPorcentaje(Number(r.colaboradores_recibieron)||0,Number(r.colaboradores_total)||0);this.totalColaboradores=a.total,this.porcentajeColaboradores=a.porcentaje}onFileSelected(r,n){let i=r.target.files[0];i&&(this.filesToUpload.set(n,i),console.log(`Archivo seleccionado: ${i.name} para ${n}`))}convertFileToBase64(r){return p(this,null,function*(){return new Promise((n,i)=>{let a=new FileReader;a.onload=()=>n(a.result),a.onerror=i,a.readAsDataURL(r)})})}submitForm3(){return p(this,null,function*(){this.markFormGroupTouched(this.datosanticorrupcion),this.datosanticorrupcion.valid?(console.log("\u2705 Formulario Anticorrupci\xF3n v\xE1lido"),yield this.sendAttachment()):(console.log("\u274C Formulario Anticorrupci\xF3n inv\xE1lido"),this.scrollToFirstError(),alert("Por favor, complete todos los campos num\xE9ricos"))})}sendAttachment(){return p(this,null,function*(){let r=[];for(let[a,v]of this.filesToUpload.entries()){console.log("\u{1F4CE} Procesando archivo:",a);let U=yield this.convertFileToBase64(v);r.push({fileName:a,fileData:U})}let n=this.formDataService.getDatosIniciales(),i=f(F({},this.datosanticorrupcion.value),{totales:{junta_directiva:{total:this.totalJuntaDirectiva,porcentaje:this.porcentajeJuntaDirectiva},comite_directivo:{total:this.totalComiteDirectivo,porcentaje:this.porcentajeComiteDirectivo},colaboradores:{total:this.totalColaboradores,porcentaje:this.porcentajeColaboradores}}});console.log("\u{1F4CA} Datos a enviar:",{archivos:r.length,datosiniciales:n,datosanticorrupcion:i}),this.formService.upload(r,n,null,i,null).subscribe({next:a=>{console.log("\u2705 Datos enviados exitosamente:",a),this.formDataService.clearDatosIniciales(),this.router.navigate(["/confirmacion"])},error:a=>{console.error("\u274C Error al enviar:",a),alert("Hubo un error al enviar los datos. Por favor, intente nuevamente.")}})})}static{this.\u0275fac=function(n){return new(n||d)(u(q),u(w),u(V),u(B),u(j))}}static{this.\u0275cmp=C({type:d,selectors:[["app-anticorrupcion"]],standalone:!0,features:[E,D],decls:111,vars:11,consts:[[1,"form-header"],["src","assets/auteco-logo.png","alt","Logo Empresa",1,"logo-empresa"],[1,"icon"],["id","progressbar"],["id","msform"],[1,"border-purple",3,"hidden"],[3,"ngSubmit","formGroup"],[1,"section-header"],[1,"fs-subtitle"],[1,"info-box"],[1,"subsection-header"],[1,"table-container"],[1,"gri-table","comite-table"],[1,"dato-solicitado"],[1,"valor-simple"],[1,"dato-label"],["type","number","formControlName","junta_recibieron","min","0","placeholder","0",3,"ngClass"],["type","number","formControlName","junta_total","min","0","placeholder","0",3,"ngClass"],[1,"valor-calculado"],[1,"resultado-porcentaje"],["type","number","formControlName","comite_recibieron","min","0","placeholder","0",3,"ngClass"],["type","number","formControlName","comite_total","min","0","placeholder","0",3,"ngClass"],["type","number","formControlName","colaboradores_recibieron","min","0","placeholder","0",3,"ngClass"],["type","number","formControlName","colaboradores_total","min","0","placeholder","0",3,"ngClass"],["type","button","value","GUARDAR Y ENVIAR",1,"action-button","success",3,"click"]],template:function(n,i){n&1&&(t(0,"div",0)(1,"h1"),m(2,"img",1),t(3,"span",2),o(4,"\u{1F4CA}"),e(),o(5," Plataforma de Gesti\xF3n - Informe de Sostenibilidad "),e(),t(6,"p"),o(7,"Sistema de recolecci\xF3n de datos para reportes GRI"),e()(),m(8,"div",3),t(9,"form",4)(10,"fieldset",5)(11,"form",6),h("ngSubmit",function(){return i.submitForm3()}),t(12,"div",7)(13,"span",2),o(14,"\u{1F6E1}\uFE0F"),e(),t(15,"h2"),o(16,"Comunicaci\xF3n y Formaci\xF3n sobre Anticorrupci\xF3n"),e()(),t(17,"p",8),o(18," GRI 205-2: Complete la informaci\xF3n sobre capacitaci\xF3n en pol\xEDticas anticorrupci\xF3n "),e(),t(19,"div",9)(20,"strong"),o(21,"\u2139\uFE0F INSTRUCCIONES:"),e(),o(22," Ingrese los valores num\xE9ricos. Los totales y porcentajes se calcular\xE1n autom\xE1ticamente. "),e(),t(23,"div",10)(24,"span",2),o(25,"\u{1F465}"),e(),o(26," GRI 205-2: Comunicaci\xF3n y formaci\xF3n sobre pol\xEDticas anticorrupci\xF3n a la junta directiva "),e(),t(27,"div",11)(28,"table",12)(29,"thead")(30,"tr")(31,"th",13),o(32,"Dato solicitado"),e(),t(33,"th",14),o(34,"Valor"),e()()(),t(35,"tbody")(36,"tr")(37,"td",15),o(38,"N\xFAmero de miembros de Junta Directiva que recibieron comunicaci\xF3n y formaci\xF3n sobre pol\xEDticas anticorrupci\xF3n."),e(),t(39,"td"),m(40,"input",16),e()(),t(41,"tr")(42,"td",15),o(43,"Total de miembros de Junta Directiva."),e(),t(44,"td"),m(45,"input",17),e()(),t(46,"tr")(47,"td",15),o(48,"Porcentaje de miembros de Junta Directiva que recibieron comunicaci\xF3n y formaci\xF3n sobre pol\xEDticas anticorrupci\xF3n."),e(),t(49,"td",18)(50,"span",19),o(51),e()()()()()(),t(52,"div",10)(53,"span",2),o(54,"\u{1F454}"),e(),o(55," GRI 205-2: Comunicaci\xF3n y formaci\xF3n sobre pol\xEDticas anticorrupci\xF3n al comit\xE9 directivo "),e(),t(56,"div",11)(57,"table",12)(58,"thead")(59,"tr")(60,"th",13),o(61,"Dato solicitado"),e(),t(62,"th",14),o(63,"Valor"),e()()(),t(64,"tbody")(65,"tr")(66,"td",15),o(67,"N\xFAmero de miembros del Comit\xE9 Directivo que recibieron comunicaci\xF3n y formaci\xF3n sobre pol\xEDticas anticorrupci\xF3n."),e(),t(68,"td"),m(69,"input",20),e()(),t(70,"tr")(71,"td",15),o(72,"Total de miembros del Comit\xE9 Directivo."),e(),t(73,"td"),m(74,"input",21),e()(),t(75,"tr")(76,"td",15),o(77,"Porcentaje de miembros del Comit\xE9 Directivo que recibieron comunicaci\xF3n y formaci\xF3n sobre pol\xEDticas anticorrupci\xF3n."),e(),t(78,"td",18)(79,"span",19),o(80),e()()()()()(),t(81,"div",10)(82,"span",2),o(83,"\u{1F477}"),e(),o(84," GRI 205-2: Comunicaci\xF3n y formaci\xF3n sobre pol\xEDticas anticorrupci\xF3n a colaboradores "),e(),t(85,"div",11)(86,"table",12)(87,"thead")(88,"tr")(89,"th",13),o(90,"Dato solicitado"),e(),t(91,"th",14),o(92,"Valor"),e()()(),t(93,"tbody")(94,"tr")(95,"td",15),o(96,"N\xFAmero de colaboradores que recibieron comunicaci\xF3n y formaci\xF3n sobre pol\xEDticas anticorrupci\xF3n."),e(),t(97,"td"),m(98,"input",22),e()(),t(99,"tr")(100,"td",15),o(101,"Total de colaboradores."),e(),t(102,"td"),m(103,"input",23),e()(),t(104,"tr")(105,"td",15),o(106,"Porcentaje de colaboradores que recibieron comunicaci\xF3n y formaci\xF3n sobre pol\xEDticas anticorrupci\xF3n."),e(),t(107,"td",18)(108,"span",19),o(109),e()()()()()(),t(110,"input",24),h("click",function(){return i.submitForm3()}),e()()()()),n&2&&(l(10),s("hidden",!i.anticorrupcion),l(),s("formGroup",i.datosanticorrupcion),l(29),s("ngClass",i.getFieldClass(i.datosanticorrupcion,"junta_recibieron")),l(5),s("ngClass",i.getFieldClass(i.datosanticorrupcion,"junta_total")),l(6),b("",i.porcentajeJuntaDirectiva.toFixed(2),"%"),l(18),s("ngClass",i.getFieldClass(i.datosanticorrupcion,"comite_recibieron")),l(5),s("ngClass",i.getFieldClass(i.datosanticorrupcion,"comite_total")),l(6),b("",i.porcentajeComiteDirectivo.toFixed(2),"%"),l(18),s("ngClass",i.getFieldClass(i.datosanticorrupcion,"colaboradores_recibieron")),l(5),s("ngClass",i.getFieldClass(i.datosanticorrupcion,"colaboradores_total")),l(6),b("",i.porcentajeColaboradores.toFixed(2),"%"))},dependencies:[g,S,P,A,y,I,_,x,G,T,R]})}}return d})();export{W as AnticorrupcionComponent};
