import{a as z}from"./chunk-2PSR7T7J.js";import{a as B,b as c,c as U,d as G,e as R,f as q,g as O,i as P,j as $,k as j,l as L,q as K,r as H,s as Y,t as Z}from"./chunk-6S4UDF73.js";import{B as a,C as b,F as k,G as h,I as s,K as i,L as t,M as u,P as f,Q as g,R as p,S as o,T as x,U as _,W as T,Y as E,Z as S,a as F,b as M,c as y,da as N,ea as I,fa as A,ga as w,ha as W,na as D,s as V,w as C,x as v}from"./chunk-ACHKL7EZ.js";function X(l,d){if(l&1&&(i(0,"span",43),o(1),t()),l&2){let e=p().$implicit,n=p();a(),_(" ",n.getErrorMessage(e,"marca")," ")}}function ee(l,d){if(l&1&&(i(0,"span",43),o(1),t()),l&2){let e=p().$implicit,n=p();a(),_(" ",n.getErrorMessage(e,"unidades_vendidas")," ")}}function te(l,d){if(l&1&&(i(0,"span",43),o(1),t()),l&2){let e=p().$implicit,n=p();a(),_(" ",n.getErrorMessage(e,"marketshare")," ")}}function ie(l,d){if(l&1){let e=f();i(0,"button",44),g("click",function(){C(e);let r=p().index,m=p();return v(m.eliminarFilaMotosCombustion(r))}),o(1," \u274C "),t()}}function re(l,d){if(l&1&&(i(0,"tr",36)(1,"td"),u(2,"input",37),h(3,X,2,1,"span",38),t(),i(4,"td"),u(5,"input",39),h(6,ee,2,1,"span",38),t(),i(7,"td"),u(8,"input",40),h(9,te,2,1,"span",38),t(),i(10,"td",41),h(11,ie,2,0,"button",42),t()()),l&2){let e=d.$implicit,n=d.index,r=p();s("formGroupName",n),a(2),s("ngClass",r.getFieldClass(e,"marca")),a(),s("ngIf",r.shouldShowError(e,"marca")),a(2),s("ngClass",r.getFieldClass(e,"unidades_vendidas")),a(),s("ngIf",r.shouldShowError(e,"unidades_vendidas")),a(2),s("ngClass",r.getFieldClass(e,"marketshare")),a(),s("ngIf",r.shouldShowError(e,"marketshare")),a(2),s("ngIf",r.motosCombustion.length>1)}}function oe(l,d){if(l&1){let e=f();i(0,"button",44),g("click",function(){C(e);let r=p().index,m=p();return v(m.eliminarFilaVentasMotos(r))}),o(1," \u274C "),t()}}function ne(l,d){if(l&1&&(i(0,"tr",36)(1,"td"),u(2,"input",45),t(),i(3,"td"),u(4,"input",46),t(),i(5,"td"),u(6,"input",39),t(),i(7,"td",41),h(8,oe,2,0,"button",42),t()()),l&2){let e=d.$implicit,n=d.index,r=p();s("formGroupName",n),a(2),s("ngClass",r.getFieldClass(e,"segmento")),a(2),s("ngClass",r.getFieldClass(e,"modelo")),a(2),s("ngClass",r.getFieldClass(e,"unidades_vendidas")),a(2),s("ngIf",r.ventasMotos.length>1)}}function ae(l,d){if(l&1){let e=f();i(0,"button",44),g("click",function(){C(e);let r=p().index,m=p();return v(m.eliminarFilaMotocarros(r))}),o(1," \u274C "),t()}}function le(l,d){if(l&1&&(i(0,"tr",36)(1,"td"),u(2,"input",37),t(),i(3,"td"),u(4,"input",39),t(),i(5,"td"),u(6,"input",40),t(),i(7,"td",41),h(8,ae,2,0,"button",42),t()()),l&2){let e=d.$implicit,n=d.index,r=p();s("formGroupName",n),a(2),s("ngClass",r.getFieldClass(e,"marca")),a(2),s("ngClass",r.getFieldClass(e,"unidades_vendidas")),a(2),s("ngClass",r.getFieldClass(e,"marketshare")),a(2),s("ngIf",r.motocarros.length>1)}}function se(l,d){if(l&1){let e=f();i(0,"button",44),g("click",function(){C(e);let r=p().index,m=p();return v(m.eliminarFilaMarketshare2W(r))}),o(1," \u274C "),t()}}function me(l,d){if(l&1&&(i(0,"tr",36)(1,"td"),u(2,"input",37),t(),i(3,"td"),u(4,"input",40),t(),i(5,"td",41),h(6,se,2,0,"button",42),t()()),l&2){let e=d.$implicit,n=d.index,r=p();s("formGroupName",n),a(2),s("ngClass",r.getFieldClass(e,"marca")),a(2),s("ngClass",r.getFieldClass(e,"marketshare")),a(2),s("ngIf",r.marketshare2W.length>1)}}function ce(l,d){if(l&1){let e=f();i(0,"button",44),g("click",function(){C(e);let r=p().index,m=p();return v(m.eliminarFilaVentas2W(r))}),o(1," \u274C "),t()}}function de(l,d){if(l&1&&(i(0,"tr",36)(1,"td"),u(2,"input",47),t(),i(3,"td"),u(4,"input",46),t(),i(5,"td"),u(6,"input",39),t(),i(7,"td",41),h(8,ce,2,0,"button",42),t()()),l&2){let e=d.$implicit,n=d.index,r=p();s("formGroupName",n),a(2),s("ngClass",r.getFieldClass(e,"segmento")),a(2),s("ngClass",r.getFieldClass(e,"modelo")),a(2),s("ngClass",r.getFieldClass(e,"unidades_vendidas")),a(2),s("ngIf",r.ventas2W.length>1)}}var xe=(()=>{class l extends Y{constructor(e,n,r,m){super(),this.formBuilder=e,this.formService=n,this.formDataService=r,this.router=m,this.comercialVictory=!0,this.datoscomerciavictory=new R({}),this.filesToUpload=new Map,this.totalUnidadesMotosCombustion=0,this.totalMarketshareMotos=0,this.totalVentasMotos=0,this.totalUnidadesMotocarros=0,this.totalMarketshareCarros=0,this.totalMarketshare2W=0,this.totalVentas2W=0}ngOnInit(){this.datoscomerciavictory=this.formBuilder.group({motos_combustion:this.formBuilder.array([]),ventas_motos:this.formBuilder.array([]),motocarros:this.formBuilder.array([]),marketshare_2w:this.formBuilder.array([]),ventas_2w:this.formBuilder.array([])}),this.agregarFilaMotosCombustion("Victory"),this.agregarFilaMotosCombustion("Kymco"),this.agregarFilaMotosCombustion("Benelli"),this.agregarFilaMotosCombustion("Kawasaki"),this.agregarFilaMotosCombustion("Zontes"),this.agregarFilaVentasMotos(),this.agregarFilaMotocarros(),this.agregarFilaMarketshare2W(),this.agregarFilaVentas2W(),this.datoscomerciavictory.valueChanges.subscribe(()=>{this.calcularTotales()}),this.calcularTotales()}get motosCombustion(){return this.datoscomerciavictory.get("motos_combustion")}agregarFilaMotosCombustion(e=""){let n=this.formBuilder.group({marca:[e,c.required],unidades_vendidas:["",[c.required,c.min(0)]],marketshare:["",[c.required,c.min(0),c.max(100)]]});n.valueChanges.subscribe(()=>this.calcularTotales()),this.motosCombustion.push(n)}eliminarFilaMotosCombustion(e){this.motosCombustion.length>1&&(this.motosCombustion.removeAt(e),this.calcularTotales())}get ventasMotos(){return this.datoscomerciavictory.get("ventas_motos")}agregarFilaVentasMotos(){let e=this.formBuilder.group({segmento:["",c.required],modelo:["",c.required],unidades_vendidas:["",[c.required,c.min(0)]]});e.valueChanges.subscribe(()=>this.calcularTotales()),this.ventasMotos.push(e)}eliminarFilaVentasMotos(e){this.ventasMotos.length>1&&(this.ventasMotos.removeAt(e),this.calcularTotales())}get motocarros(){return this.datoscomerciavictory.get("motocarros")}agregarFilaMotocarros(){let e=this.formBuilder.group({marca:["",c.required],unidades_vendidas:["",[c.required,c.min(0)]],marketshare:["",[c.required,c.min(0),c.max(100)]]});e.valueChanges.subscribe(()=>this.calcularTotales()),this.motocarros.push(e)}eliminarFilaMotocarros(e){this.motocarros.length>1&&(this.motocarros.removeAt(e),this.calcularTotales())}get marketshare2W(){return this.datoscomerciavictory.get("marketshare_2w")}agregarFilaMarketshare2W(){let e=this.formBuilder.group({marca:["",c.required],marketshare:["",[c.required,c.min(0),c.max(100)]]});e.valueChanges.subscribe(()=>this.calcularTotales()),this.marketshare2W.push(e)}eliminarFilaMarketshare2W(e){this.marketshare2W.length>1&&(this.marketshare2W.removeAt(e),this.calcularTotales())}get ventas2W(){return this.datoscomerciavictory.get("ventas_2w")}agregarFilaVentas2W(){let e=this.formBuilder.group({segmento:["",c.required],modelo:["",c.required],unidades_vendidas:["",[c.required,c.min(0)]]});e.valueChanges.subscribe(()=>this.calcularTotales()),this.ventas2W.push(e)}eliminarFilaVentas2W(e){this.ventas2W.length>1&&(this.ventas2W.removeAt(e),this.calcularTotales())}calcularTotales(){this.totalUnidadesMotosCombustion=this.motosCombustion.controls.reduce((e,n)=>e+(Number(n.get("unidades_vendidas")?.value)||0),0),this.totalMarketshareMotos=this.motosCombustion.controls.reduce((e,n)=>e+(Number(n.get("marketshare")?.value)||0),0),this.totalVentasMotos=this.ventasMotos.controls.reduce((e,n)=>e+(Number(n.get("unidades_vendidas")?.value)||0),0),this.totalUnidadesMotocarros=this.motocarros.controls.reduce((e,n)=>e+(Number(n.get("unidades_vendidas")?.value)||0),0),this.totalMarketshareCarros=this.motocarros.controls.reduce((e,n)=>e+(Number(n.get("marketshare")?.value)||0),0),this.totalMarketshare2W=this.marketshare2W.controls.reduce((e,n)=>e+(Number(n.get("marketshare")?.value)||0),0),this.totalVentas2W=this.ventas2W.controls.reduce((e,n)=>e+(Number(n.get("unidades_vendidas")?.value)||0),0)}getNumericValue(e){return Number(this.datoscomerciavictory.get(e)?.value)||0}onFileSelected(e,n){let r=e.target.files[0];r&&(this.filesToUpload.set(n,r),console.log(`Archivo seleccionado: ${r.name} para ${n}`))}convertFileToBase64(e){return y(this,null,function*(){return new Promise((n,r)=>{let m=new FileReader;m.onload=()=>n(m.result),m.onerror=r,m.readAsDataURL(e)})})}submitFormComercialVictory(){return y(this,null,function*(){this.markFormGroupTouched(this.datoscomerciavictory),this.datoscomerciavictory.valid?(console.log("\u2705 Formulario Comercial Victory+ v\xE1lido"),yield this.sendAttachment()):(console.log("\u274C Formulario Comercial Victory+ inv\xE1lido"),this.scrollToFirstError(),alert("Por favor, complete todos los campos obligatorios"))})}sendAttachment(){return y(this,null,function*(){let e=[];for(let[m,J]of this.filesToUpload.entries()){console.log("\u{1F4CE} Procesando archivo:",m);let Q=yield this.convertFileToBase64(J);e.push({fileName:m,fileData:Q})}let n=this.formDataService.getDatosIniciales(),r=M(F({},this.datoscomerciavictory.value),{totales:{motos_combustion:{unidades:this.totalUnidadesMotosCombustion,marketshare:this.totalMarketshareMotos},ventas_motos_modelo:this.totalVentasMotos,motocarros:{unidades:this.totalUnidadesMotocarros,marketshare:this.totalMarketshareCarros},marketshare_2w:this.totalMarketshare2W,ventas_2w:this.totalVentas2W},fecha_reporte:new Date().toISOString()});console.log("\u{1F4CA} Datos a enviar:",r),this.formService.upload(e,n,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,r).subscribe({next:m=>{console.log("\u2705 Datos enviados exitosamente:",m),this.formDataService.clearDatosIniciales(),this.router.navigate(["/confirmacion"])},error:m=>{console.error("\u274C Error al enviar:",m),alert("Hubo un error al enviar los datos. Por favor, intente nuevamente.")}})})}static{this.\u0275fac=function(n){return new(n||l)(b(K),b(z),b(Z),b(D))}}static{this.\u0275cmp=V({type:l,selectors:[["app-comercial-victory"]],standalone:!0,features:[k,T],decls:169,vars:23,consts:[[1,"form-header"],[1,"header-content"],["src","assets/logo.png","alt","Logo Empresa",1,"logo-empresa"],[1,"header-text"],["id","progressbar"],["id","msform"],[1,"border-victory",3,"hidden"],[3,"ngSubmit","formGroup"],[1,"section-header"],[1,"icon"],[1,"fs-subtitle"],[1,"info-box"],[1,"subsection-header"],[1,"table-subtitle"],[1,"table-container"],[1,"gri-table","victory-table"],[1,"acciones-col"],["formArrayName","motos_combustion"],[3,"formGroupName",4,"ngFor","ngForOf"],[1,"totales-row"],[1,"total-label"],[1,"total-cell"],[1,"resultado-total"],[1,"resultado-total-final"],["type","button",1,"btn-agregar-fila",3,"click"],[1,"table-subtitle",2,"margin-top","40px"],[1,"gri-table","victory-table-ventas"],["formArrayName","ventas_motos"],["colspan","2",1,"total-label"],[1,"table-subtitle",2,"margin-top","50px"],["formArrayName","motocarros"],[1,"subsection-header",2,"margin-top","50px"],[1,"gri-table","victory-table-simple"],["formArrayName","marketshare_2w"],["formArrayName","ventas_2w"],["type","button","value","GUARDAR Y ENVIAR",1,"action-button","success",3,"click"],[3,"formGroupName"],["type","text","formControlName","marca","placeholder","Nombre de la marca",3,"ngClass"],["class","error-text",4,"ngIf"],["type","number","formControlName","unidades_vendidas","placeholder","0",3,"ngClass"],["type","number","formControlName","marketshare","step","0.01","placeholder","0.00",3,"ngClass"],[1,"acciones-cell"],["type","button","class","btn-eliminar","title","Eliminar fila",3,"click",4,"ngIf"],[1,"error-text"],["type","button","title","Eliminar fila",1,"btn-eliminar",3,"click"],["type","text","formControlName","segmento","placeholder","Ej: Scooter, Sport, etc.",3,"ngClass"],["type","text","formControlName","modelo","placeholder","Nombre del modelo",3,"ngClass"],["type","text","formControlName","segmento","placeholder","Ej: Urbano, Delivery, etc.",3,"ngClass"]],template:function(n,r){n&1&&(i(0,"div",0)(1,"div",1),u(2,"img",2),i(3,"div",3)(4,"h1"),o(5,"Plataforma de Gesti\xF3n - Informe de Sostenibilidad"),t(),i(6,"p"),o(7,"Sistema de recolecci\xF3n de datos para reportes GRI"),t()()()(),u(8,"div",4),i(9,"form",5)(10,"fieldset",6)(11,"form",7),g("ngSubmit",function(){return r.submitFormComercialVictory()}),i(12,"div",8)(13,"span",9),o(14,"\u{1F3CD}\uFE0F"),t(),i(15,"h2"),o(16,"Participaci\xF3n en el Mercado de Combusti\xF3n"),t()(),i(17,"p",10),o(18," Complete la informaci\xF3n sobre participaci\xF3n en el mercado de veh\xEDculos de combusti\xF3n (motocicletas, motocarros) y el\xE9ctricos (ciclomotores 2W) "),t(),i(19,"div",11)(20,"strong"),o(21,"\u2139\uFE0F INSTRUCCIONES:"),t(),o(22," Complete los datos seg\xFAn corresponda. Las tablas con marcas fijas tienen 5 marcas, las dem\xE1s permiten agregar filas. "),t(),i(23,"div",12)(24,"span",9),o(25,"\u{1F3C1}"),t(),o(26," PARTICIPACI\xD3N EN EL MERCADO DE COMBUSTI\xD3N - Contenido GRI: N/A "),t(),i(27,"h3",13),o(28,"Participaci\xF3n en el mercado de motocicletas a combusti\xF3n"),t(),i(29,"div",14)(30,"table",15)(31,"thead")(32,"tr")(33,"th"),o(34,"Marca"),t(),i(35,"th"),o(36,"Unidades vendidas"),t(),i(37,"th"),o(38,"Marketshare (%)"),t(),i(39,"th",16),o(40,"Acciones"),t()()(),i(41,"tbody",17),h(42,re,12,8,"tr",18),i(43,"tr",19)(44,"td",20)(45,"strong"),o(46,"Total"),t()(),i(47,"td",21)(48,"span",22),o(49),t()(),i(50,"td",21)(51,"span",23),o(52),E(53,"number"),t()(),u(54,"td"),t()()()(),i(55,"button",24),g("click",function(){return r.agregarFilaMotosCombustion("")}),o(56," \u2795 Agregar marca de motocicleta "),t(),i(57,"h3",25),o(58,"Ventas por modelo y segmento de motocicletas a combusti\xF3n"),t(),i(59,"div",14)(60,"table",26)(61,"thead")(62,"tr")(63,"th"),o(64,"Segmento"),t(),i(65,"th"),o(66,"Modelo"),t(),i(67,"th"),o(68,"Unidades vendidas"),t(),i(69,"th",16),o(70,"Acciones"),t()()(),i(71,"tbody",27),h(72,ne,9,5,"tr",18),i(73,"tr",19)(74,"td",28)(75,"strong"),o(76,"Total"),t()(),i(77,"td",21)(78,"span",23),o(79),t()(),u(80,"td"),t()()()(),i(81,"button",24),g("click",function(){return r.agregarFilaVentasMotos()}),o(82," \u2795 Agregar modelo de motocicleta "),t(),i(83,"h3",29),o(84,"Participaci\xF3n en el mercado de motocarros a combusti\xF3n"),t(),i(85,"div",14)(86,"table",15)(87,"thead")(88,"tr")(89,"th"),o(90,"Marca"),t(),i(91,"th"),o(92,"Unidades vendidas"),t(),i(93,"th"),o(94,"Marketshare (%)"),t(),i(95,"th",16),o(96,"Acciones"),t()()(),i(97,"tbody",30),h(98,le,9,5,"tr",18),i(99,"tr",19)(100,"td",20)(101,"strong"),o(102,"Total"),t()(),i(103,"td",21)(104,"span",22),o(105),t()(),i(106,"td",21)(107,"span",23),o(108),E(109,"number"),t()(),u(110,"td"),t()()()(),i(111,"button",24),g("click",function(){return r.agregarFilaMotocarros()}),o(112," \u2795 Agregar marca de motocarro "),t(),i(113,"div",31)(114,"span",9),o(115,"\u26A1"),t(),o(116," PARTICIPACI\xD3N EN EL MERCADO EL\xC9CTRICO 2W - Contenido GRI: N/A "),t(),i(117,"h3",13),o(118,"Participaci\xF3n en el mercado de ciclomotores el\xE9ctricos"),t(),i(119,"div",14)(120,"table",32)(121,"thead")(122,"tr")(123,"th"),o(124,"Marca"),t(),i(125,"th"),o(126,"Marketshare (%)"),t(),i(127,"th",16),o(128,"Acciones"),t()()(),i(129,"tbody",33),h(130,me,7,4,"tr",18),i(131,"tr",19)(132,"td",20)(133,"strong"),o(134,"Total"),t()(),i(135,"td",21)(136,"span",23),o(137),E(138,"number"),t()(),u(139,"td"),t()()()(),i(140,"button",24),g("click",function(){return r.agregarFilaMarketshare2W()}),o(141," \u2795 Agregar marca de ciclomotor el\xE9ctrico "),t(),i(142,"h3",25),o(143,"Ventas por modelo y segmento de ciclomotores el\xE9ctricos"),t(),i(144,"div",14)(145,"table",26)(146,"thead")(147,"tr")(148,"th"),o(149,"Segmento"),t(),i(150,"th"),o(151,"Modelo"),t(),i(152,"th"),o(153,"Unidades vendidas"),t(),i(154,"th",16),o(155,"Acciones"),t()()(),i(156,"tbody",34),h(157,de,9,5,"tr",18),i(158,"tr",19)(159,"td",28)(160,"strong"),o(161,"Total"),t()(),i(162,"td",21)(163,"span",23),o(164),t()(),u(165,"td"),t()()()(),i(166,"button",24),g("click",function(){return r.agregarFilaVentas2W()}),o(167," \u2795 Agregar modelo de ciclomotor el\xE9ctrico "),t(),i(168,"input",35),g("click",function(){return r.submitFormComercialVictory()}),t()()()()),n&2&&(a(10),s("hidden",!r.comercialVictory),a(),s("formGroup",r.datoscomerciavictory),a(31),s("ngForOf",r.motosCombustion.controls),a(7),x(r.totalUnidadesMotosCombustion),a(3),_("",S(53,14,r.totalMarketshareMotos,"1.2-2"),"%"),a(20),s("ngForOf",r.ventasMotos.controls),a(7),x(r.totalVentasMotos),a(19),s("ngForOf",r.motocarros.controls),a(7),x(r.totalUnidadesMotocarros),a(3),_("",S(109,17,r.totalMarketshareCarros,"1.2-2"),"%"),a(22),s("ngForOf",r.marketshare2W.controls),a(7),_("",S(138,20,r.totalMarketshare2W,"1.2-2"),"%"),a(20),s("ngForOf",r.ventas2W.controls),a(7),x(r.totalVentas2W))},dependencies:[W,N,I,A,w,H,q,B,O,U,G,P,L,$,j]})}}return l})();export{xe as ComercialVictoryComponent};
