import{a as B}from"./chunk-24KBMFR6.js";import{a as w}from"./chunk-2PSR7T7J.js";import{a as D,b as c,c as j,d as T,e as x,f as N,g as I,i as R,l as A,q as G,r as q,s as J,t as P,u as V}from"./chunk-IAQZ57CQ.js";import{B as l,C as d,F,I as s,K as t,L as e,M as m,Q as h,S as i,U as E,W as _,a as v,b as C,c as p,da as S,ha as g,na as y,s as f}from"./chunk-ACHKL7EZ.js";var W=(()=>{class u extends P{constructor(r,n,a,o,b){super(),this.formBuilder=r,this.formService=n,this.formDataService=a,this.calculadora=o,this.router=b,this.eticatransparencia=!0,this.datoseticatransparencia=new x({}),this.filesToUpload=new Map,this.totalJuntaEtica=0,this.porcentajeJuntaEtica=0,this.totalComiteEtica=0,this.porcentajeComiteEtica=0,this.totalColaboradoresEtica=0,this.porcentajeColaboradoresEtica=0}ngOnInit(){this.datoseticatransparencia=this.formBuilder.group({junta_etica_recibieron:[0,[c.required,c.min(0)]],junta_etica_total:[0,[c.required,c.min(0)]],comite_etica_recibieron:[0,[c.required,c.min(0)]],comite_etica_total:[0,[c.required,c.min(0)]],colaboradores_etica_recibieron:[0,[c.required,c.min(0)]],colaboradores_etica_total:[0,[c.required,c.min(0)]]}),this.calcularTotalesEticaTransparencia(),this.datoseticatransparencia.valueChanges.subscribe(()=>{this.calcularTotalesEticaTransparencia()})}calcularTotalesEticaTransparencia(){let r=this.datoseticatransparencia.value,n=this.calculadora.calcularPorcentaje(Number(r.junta_etica_recibieron)||0,Number(r.junta_etica_total)||0);this.totalJuntaEtica=n.total,this.porcentajeJuntaEtica=n.porcentaje;let a=this.calculadora.calcularPorcentaje(Number(r.comite_etica_recibieron)||0,Number(r.comite_etica_total)||0);this.totalComiteEtica=a.total,this.porcentajeComiteEtica=a.porcentaje;let o=this.calculadora.calcularPorcentaje(Number(r.colaboradores_etica_recibieron)||0,Number(r.colaboradores_etica_total)||0);this.totalColaboradoresEtica=o.total,this.porcentajeColaboradoresEtica=o.porcentaje}onFileSelected(r,n){let a=r.target.files[0];a&&(this.filesToUpload.set(n,a),console.log(`Archivo seleccionado: ${a.name} para ${n}`))}convertFileToBase64(r){return p(this,null,function*(){return new Promise((n,a)=>{let o=new FileReader;o.onload=()=>n(o.result),o.onerror=a,o.readAsDataURL(r)})})}submitForm4(){return p(this,null,function*(){this.markFormGroupTouched(this.datoseticatransparencia),this.datoseticatransparencia.valid?(console.log("\u2705 Formulario \xC9tica y Transparencia v\xE1lido"),yield this.sendAttachment()):(console.log("\u274C Formulario \xC9tica y Transparencia inv\xE1lido"),this.scrollToFirstError(),alert("Por favor, complete todos los campos num\xE9ricos"))})}sendAttachment(){return p(this,null,function*(){let r=[];for(let[o,b]of this.filesToUpload.entries()){console.log("\u{1F4CE} Procesando archivo:",o);let U=yield this.convertFileToBase64(b);r.push({fileName:o,fileData:U})}let n=this.formDataService.getDatosIniciales(),a=C(v({},this.datoseticatransparencia.value),{totales:{junta_directiva:{total:this.totalJuntaEtica,porcentaje:this.porcentajeJuntaEtica},comite_directivo:{total:this.totalComiteEtica,porcentaje:this.porcentajeComiteEtica},colaboradores:{total:this.totalColaboradoresEtica,porcentaje:this.porcentajeColaboradoresEtica}}});console.log("\u{1F4CA} Datos a enviar:",{archivos:r.length,datosiniciales:n,datoseticatransparencia:a}),this.formService.upload(r,n,null,null,a).subscribe({next:o=>{console.log("\u2705 Datos enviados exitosamente:",o),this.formDataService.clearDatosIniciales(),this.router.navigate(["/confirmacion"])},error:o=>{console.error("\u274C Error al enviar:",o),alert("Hubo un error al enviar los datos. Por favor, intente nuevamente.")}})})}static{this.\u0275fac=function(n){return new(n||u)(d(q),d(w),d(V),d(B),d(y))}}static{this.\u0275cmp=f({type:u,selectors:[["app-etica-transparencia"]],standalone:!0,features:[F,_],decls:110,vars:11,consts:[[1,"form-header"],["src","assets/auteco-logo.png","alt","Logo Empresa",1,"logo-empresa"],[1,"icon"],["id","msform"],[1,"border-green",3,"hidden"],[3,"ngSubmit","formGroup"],[1,"section-header"],[1,"fs-subtitle"],[1,"info-box"],[1,"subsection-header"],[1,"table-container"],[1,"gri-table","comite-table"],[1,"dato-solicitado"],[1,"valor-simple"],[1,"dato-label"],["type","number","formControlName","junta_etica_recibieron","min","0","placeholder","0",3,"ngClass"],["type","number","formControlName","junta_etica_total","min","0","placeholder","0",3,"ngClass"],[1,"valor-calculado"],[1,"resultado-porcentaje"],["type","number","formControlName","comite_etica_recibieron","min","0","placeholder","0",3,"ngClass"],["type","number","formControlName","comite_etica_total","min","0","placeholder","0",3,"ngClass"],["type","number","formControlName","colaboradores_etica_recibieron","min","0","placeholder","0",3,"ngClass"],["type","number","formControlName","colaboradores_etica_total","min","0","placeholder","0",3,"ngClass"],["type","button","value","GUARDAR Y ENVIAR",1,"action-button","success",3,"click"]],template:function(n,a){n&1&&(t(0,"div",0)(1,"h1"),m(2,"img",1),t(3,"span",2),i(4,"\u{1F4CA}"),e(),i(5," Plataforma de Gesti\xF3n - Informe de Sostenibilidad "),e(),t(6,"p"),i(7,"Sistema de recolecci\xF3n de datos para reportes GRI"),e()(),t(8,"form",3)(9,"fieldset",4)(10,"form",5),h("ngSubmit",function(){return a.submitForm4()}),t(11,"div",6)(12,"span",2),i(13,"\u2696\uFE0F"),e(),t(14,"h2"),i(15,"Comunicaci\xF3n y Formaci\xF3n sobre \xC9tica y Transparencia"),e()(),t(16,"p",7),i(17," GRI 2-23: Complete la informaci\xF3n sobre capacitaci\xF3n en pol\xEDticas de \xE9tica y transparencia empresarial "),e(),t(18,"div",8)(19,"strong"),i(20,"\u2139\uFE0F INSTRUCCIONES:"),e(),i(21," Ingrese los valores num\xE9ricos. Los totales y porcentajes se calcular\xE1n autom\xE1ticamente. "),e(),t(22,"div",9)(23,"span",2),i(24,"\u{1F465}"),e(),i(25," GRI 2-23: Formaci\xF3n sobre pol\xEDticas y compromisos con la \xE9tica y transparencia empresarial a la Junta Directiva "),e(),t(26,"div",10)(27,"table",11)(28,"thead")(29,"tr")(30,"th",12),i(31,"Dato solicitado"),e(),t(32,"th",13),i(33,"Valor"),e()()(),t(34,"tbody")(35,"tr")(36,"td",14),i(37,"N\xFAmero de miembros de Junta Directiva que recibieron comunicaci\xF3n y formaci\xF3n sobre \xE9tica y transparencia."),e(),t(38,"td"),m(39,"input",15),e()(),t(40,"tr")(41,"td",14),i(42,"Total de miembros de Junta Directiva."),e(),t(43,"td"),m(44,"input",16),e()(),t(45,"tr")(46,"td",14),i(47,"Porcentaje de miembros de Junta Directiva que recibieron comunicaci\xF3n y formaci\xF3n sobre pol\xEDticas \xE9tica y transparencia."),e(),t(48,"td",17)(49,"span",18),i(50),e()()()()()(),t(51,"div",9)(52,"span",2),i(53,"\u{1F454}"),e(),i(54," GRI 2-23: Formaci\xF3n sobre pol\xEDticas y compromisos con la \xE9tica y transparencia empresarial al Comit\xE9 Directivo "),e(),t(55,"div",10)(56,"table",11)(57,"thead")(58,"tr")(59,"th",12),i(60,"Dato solicitado"),e(),t(61,"th",13),i(62,"Valor"),e()()(),t(63,"tbody")(64,"tr")(65,"td",14),i(66,"N\xFAmero de miembros del Comit\xE9 Directivo que recibieron comunicaci\xF3n y formaci\xF3n sobre pol\xEDticas \xE9tica y transparencia."),e(),t(67,"td"),m(68,"input",19),e()(),t(69,"tr")(70,"td",14),i(71,"Total de miembros del Comit\xE9 Directivo."),e(),t(72,"td"),m(73,"input",20),e()(),t(74,"tr")(75,"td",14),i(76,"Porcentaje de miembros del Comit\xE9 Directivo que recibieron comunicaci\xF3n y formaci\xF3n sobre \xE9tica y transparencia."),e(),t(77,"td",17)(78,"span",18),i(79),e()()()()()(),t(80,"div",9)(81,"span",2),i(82,"\u{1F477}"),e(),i(83," GRI 2-23: Formaci\xF3n sobre pol\xEDticas y compromisos con la \xE9tica y transparencia empresarial a Colaboradores "),e(),t(84,"div",10)(85,"table",11)(86,"thead")(87,"tr")(88,"th",12),i(89,"Dato solicitado"),e(),t(90,"th",13),i(91,"Valor"),e()()(),t(92,"tbody")(93,"tr")(94,"td",14),i(95,"N\xFAmero de colaboradores que recibieron comunicaci\xF3n y formaci\xF3n sobre pol\xEDticas \xE9tica y transparencia."),e(),t(96,"td"),m(97,"input",21),e()(),t(98,"tr")(99,"td",14),i(100,"Total de colaboradores."),e(),t(101,"td"),m(102,"input",22),e()(),t(103,"tr")(104,"td",14),i(105,"Porcentaje de colaboradores que recibieron comunicaci\xF3n y formaci\xF3n sobre \xE9tica y transparencia."),e(),t(106,"td",17)(107,"span",18),i(108),e()()()()()(),t(109,"input",23),h("click",function(){return a.submitForm4()}),e()()()()),n&2&&(l(9),s("hidden",!a.eticatransparencia),l(),s("formGroup",a.datoseticatransparencia),l(29),s("ngClass",a.getFieldClass(a.datoseticatransparencia,"junta_etica_recibieron")),l(5),s("ngClass",a.getFieldClass(a.datoseticatransparencia,"junta_etica_total")),l(6),E("",a.porcentajeJuntaEtica.toFixed(2),"%"),l(18),s("ngClass",a.getFieldClass(a.datoseticatransparencia,"comite_etica_recibieron")),l(5),s("ngClass",a.getFieldClass(a.datoseticatransparencia,"comite_etica_total")),l(6),E("",a.porcentajeComiteEtica.toFixed(2),"%"),l(18),s("ngClass",a.getFieldClass(a.datoseticatransparencia,"colaboradores_etica_recibieron")),l(5),s("ngClass",a.getFieldClass(a.datoseticatransparencia,"colaboradores_etica_total")),l(6),E("",a.porcentajeColaboradoresEtica.toFixed(2),"%"))},dependencies:[g,S,J,N,D,I,j,T,G,R,A]})}}return u})();export{W as EticaTransparenciaComponent};
